{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useCallback, useEffect, useState } from \"react\";\nimport { CanceledError } from \"axios\";\nimport { Post } from \"../+requests\";\nimport moment from \"moment/moment\";\nexport function usePostsRetriever({\n  page,\n  startDate\n}) {\n  _s();\n  const [list, setList] = useState([]);\n  const [isListError, setIsListError] = useState(false);\n  const [isListLoading, setIsListLoading] = useState(false);\n  const [isInitialized, setIsInitialized] = useState(false);\n  const [isLastPage, setIsLastPage] = useState(false);\n  const getList = useCallback(async abortSignal => {\n    if (isLastPage) {\n      return;\n    }\n    setIsListLoading(true);\n    setIsListError(false);\n    try {\n      const res = await Post.getList({\n        page,\n        items_per_page: 35,\n        end_date: moment().toISOString(),\n        start_date: startDate\n      }, abortSignal);\n      const newList = res.data.data;\n      if (newList.length === 0) {\n        setIsLastPage(true);\n      }\n      setList(list => [...list, ...newList]);\n    } catch (error) {\n      if (!(error instanceof CanceledError)) {\n        setIsListError(true);\n      }\n    } finally {\n      setIsListLoading(false);\n      setIsInitialized(true);\n    }\n  }, [isLastPage, page, startDate]);\n  useEffect(() => {\n    const ac = new AbortController();\n    void getList(ac.signal);\n    return () => {\n      ac.abort();\n    };\n  }, [getList]);\n  return {\n    list,\n    isListInitialized: isInitialized,\n    isListError,\n    isListLoading,\n    fetchList: getList\n  };\n}\n_s(usePostsRetriever, \"mJA8A+hsldr45T9v9qPhr8VbHxw=\");","map":{"version":3,"names":["useCallback","useEffect","useState","CanceledError","Post","moment","usePostsRetriever","page","startDate","_s","list","setList","isListError","setIsListError","isListLoading","setIsListLoading","isInitialized","setIsInitialized","isLastPage","setIsLastPage","getList","abortSignal","res","items_per_page","end_date","toISOString","start_date","newList","data","length","error","ac","AbortController","signal","abort","isListInitialized","fetchList"],"sources":["/Users/sivanthisittravell/Downloads/mashable-posts-ui/src/app/posts/use-posts-retriever.ts"],"sourcesContent":["import {useCallback, useEffect, useState} from \"react\";\nimport {CanceledError, GenericAbortSignal} from \"axios\";\nimport {Post, PostItem, PostListResponseModel} from \"../+requests\";\nimport moment from \"moment/moment\";\n\ninterface Props {\n    page: number;\n    startDate: string;\n}\n\nexport function usePostsRetriever({\n    page,\n    startDate\n}: Props) {\n    const [list, setList] = useState<PostItem[]>([])\n    const [isListError, setIsListError] = useState(false)\n    const [isListLoading, setIsListLoading] = useState(false)\n    const [isInitialized, setIsInitialized] = useState(false)\n    const [isLastPage, setIsLastPage] = useState(false)\n\n    const getList = useCallback(async (abortSignal?: GenericAbortSignal) => {\n        if (isLastPage) {\n            return;\n        }\n\n        setIsListLoading(true)\n        setIsListError(false)\n\n        try {\n            const res: PostListResponseModel = await Post.getList(\n                {\n                    page,\n                    items_per_page: 35,\n                    end_date: moment().toISOString(),\n                    start_date: startDate,\n                },\n                abortSignal\n            )\n\n            const newList = res.data.data\n\n            if (newList.length === 0) {\n                setIsLastPage(true)\n            }\n\n            setList(list => [...list, ...newList])\n        } catch (error) {\n            if (!(error instanceof CanceledError)) {\n                setIsListError(true)\n            }\n        } finally {\n            setIsListLoading(false)\n            setIsInitialized(true)\n        }\n\n    }, [isLastPage, page, startDate]);\n\n    useEffect(() => {\n        const ac = new AbortController()\n        void getList(ac.signal)\n\n        return () => {\n            ac.abort()\n        }\n    }, [getList]);\n\n    return {\n        list,\n        isListInitialized: isInitialized,\n        isListError,\n        isListLoading,\n        fetchList: getList,\n    }\n}\n"],"mappings":";AAAA,SAAQA,WAAW,EAAEC,SAAS,EAAEC,QAAQ,QAAO,OAAO;AACtD,SAAQC,aAAa,QAA2B,OAAO;AACvD,SAAQC,IAAI,QAAwC,cAAc;AAClE,OAAOC,MAAM,MAAM,eAAe;AAOlC,OAAO,SAASC,iBAAiBA,CAAC;EAC9BC,IAAI;EACJC;AACG,CAAC,EAAE;EAAAC,EAAA;EACN,MAAM,CAACC,IAAI,EAAEC,OAAO,CAAC,GAAGT,QAAQ,CAAa,EAAE,CAAC;EAChD,MAAM,CAACU,WAAW,EAAEC,cAAc,CAAC,GAAGX,QAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACY,aAAa,EAAEC,gBAAgB,CAAC,GAAGb,QAAQ,CAAC,KAAK,CAAC;EACzD,MAAM,CAACc,aAAa,EAAEC,gBAAgB,CAAC,GAAGf,QAAQ,CAAC,KAAK,CAAC;EACzD,MAAM,CAACgB,UAAU,EAAEC,aAAa,CAAC,GAAGjB,QAAQ,CAAC,KAAK,CAAC;EAEnD,MAAMkB,OAAO,GAAGpB,WAAW,CAAC,MAAOqB,WAAgC,IAAK;IACpE,IAAIH,UAAU,EAAE;MACZ;IACJ;IAEAH,gBAAgB,CAAC,IAAI,CAAC;IACtBF,cAAc,CAAC,KAAK,CAAC;IAErB,IAAI;MACA,MAAMS,GAA0B,GAAG,MAAMlB,IAAI,CAACgB,OAAO,CACjD;QACIb,IAAI;QACJgB,cAAc,EAAE,EAAE;QAClBC,QAAQ,EAAEnB,MAAM,CAAC,CAAC,CAACoB,WAAW,CAAC,CAAC;QAChCC,UAAU,EAAElB;MAChB,CAAC,EACDa,WACJ,CAAC;MAED,MAAMM,OAAO,GAAGL,GAAG,CAACM,IAAI,CAACA,IAAI;MAE7B,IAAID,OAAO,CAACE,MAAM,KAAK,CAAC,EAAE;QACtBV,aAAa,CAAC,IAAI,CAAC;MACvB;MAEAR,OAAO,CAACD,IAAI,IAAI,CAAC,GAAGA,IAAI,EAAE,GAAGiB,OAAO,CAAC,CAAC;IAC1C,CAAC,CAAC,OAAOG,KAAK,EAAE;MACZ,IAAI,EAAEA,KAAK,YAAY3B,aAAa,CAAC,EAAE;QACnCU,cAAc,CAAC,IAAI,CAAC;MACxB;IACJ,CAAC,SAAS;MACNE,gBAAgB,CAAC,KAAK,CAAC;MACvBE,gBAAgB,CAAC,IAAI,CAAC;IAC1B;EAEJ,CAAC,EAAE,CAACC,UAAU,EAAEX,IAAI,EAAEC,SAAS,CAAC,CAAC;EAEjCP,SAAS,CAAC,MAAM;IACZ,MAAM8B,EAAE,GAAG,IAAIC,eAAe,CAAC,CAAC;IAChC,KAAKZ,OAAO,CAACW,EAAE,CAACE,MAAM,CAAC;IAEvB,OAAO,MAAM;MACTF,EAAE,CAACG,KAAK,CAAC,CAAC;IACd,CAAC;EACL,CAAC,EAAE,CAACd,OAAO,CAAC,CAAC;EAEb,OAAO;IACHV,IAAI;IACJyB,iBAAiB,EAAEnB,aAAa;IAChCJ,WAAW;IACXE,aAAa;IACbsB,SAAS,EAAEhB;EACf,CAAC;AACL;AAACX,EAAA,CA/DeH,iBAAiB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}